% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Subclustering.R
\name{SubClusCSFNMF}
\alias{SubClusCSFNMF}
\title{Perform Sub-clustering Analysis on CSFNMF Results}
\usage{
SubClusCSFNMF(
  object,
  resolution = 0.5,
  algorithm = 1,
  min_cells = 30,
  verbose = TRUE
)
}
\arguments{
\item{object}{A CSFNMF object with completed training}

\item{resolution}{Clustering resolution parameter (default: 0.5)}

\item{algorithm}{Clustering algorithm (1: Louvain, 2: Leiden, 3: SLM, 4: LabelProp)}

\item{min_cells}{Minimum number of cells required for sub-clustering (default: 30)}

\item{verbose}{Show progress messages (default: TRUE)}
}
\value{
Updated CSFNMF object with sub-clustering results stored in annotations
}
\description{
Identifies and predicts cell sub-clusters based on the CSFNMF factorization results.
This function performs sub-clustering on both reference and query datasets,
preserving the hierarchical relationship between main cell types and sub-clusters.
}
\details{
The function performs the following steps:
\enumerate{
\item Identifies sub-clusters in the reference dataset using Seurat clustering
\item Updates reference annotations with sub-cluster information
\item Predicts sub-clusters for the query dataset using SingleR
\item Stores both original and sub-clustered annotations
}
}
\examples{
\dontrun{
# Train CSFNMF model
object_trained <- RunCSFNMF(object)

# Perform sub-clustering with default parameters
object_subclustered <- SubClusCSFNMF(object_trained)

# Use different resolution and algorithm
object_subclustered <- SubClusCSFNMF(
  object_trained,
  resolution = 0.8,
  algorithm = 2  # Use Leiden algorithm
)

# Access sub-clustering results
head(object_subclustered@annotation$subclusters)
}

}
